# 목차
1. [웹의 기본 아키텍처](#앱의_기본_아키택처)
2. [왜 데이터베이스가 병목일까?](#02._왜_데이터베이스가_병목일까?)
3. [대용량 시스템 아키텍처 맛보기](03._대용량_스스템_아키텍처_맛보기)

# 01. 앱의 기본 아키택처
## 웹 서버, 웹 어플리케이션 서버는 왜 나눠져 있을까?
웹서버 -> 웹의 복잡도가 증가함에 따라서 서버 분리

관심사의 분리
관측가능한 시스템
효율적인 리소스 사용
등

레이어가 많아질 수록 관리포인트가 많아지고 시스템 복잡도가 상승하게 됨.
관리가 어려워짐.

# 02. 왜 데이터베이스가 병목일까?
## 스케일 업(scale up)과 스케일 아웃(scale out)
스케일 업 -> 서버의 크기를 키움
스케일 아웃 -> 서버의 갯수를 늘림

|  | 스케일 업 | 스케일 아웃 |
| ---- | ---- | ---- |
| 유지보수 및 관리 | 쉬움 | 여러노드에 적절히 부하분산 필요 |
| 확장성 | 제약이 있음 | 스케일업에 비해 자유로움 |
| 장애복구 | 서버가 1대, 다운타임이 있음 | 장애 탄력성이 있음 |

## 언제 스케일 아웃이 가능한가?
대용량 처리를 위해선 스케일 업보단 스케일 아웃이 좀 더 유리해보임.
스케일 아웃이여도 클라이언트에게는 하나의 서버인 것 처럼 동작해야한다.
여러개의 서버가 하나의 데이터 베이스를 바라보도록 구성

### 그렇다면 데이터베이스를 스케일 아웃을 하기 어려울까?
데이터 베이스는 데이터라는 상태를 관리하고 있어 서버보다 스케일 아웃을 하기 위해서는 훨씬 많은 비용이 필요
그래서 현대 서버 아키텍처는 상태고나리를 데이터 베이스에 위임하고, 서버는 상태 관리를 하지 않는 방향으로 발전.
데이터베이스는 스케일 아웃 외에도 디스크의 데이터를 접근해서 가져오기떄문에 속도가 다소 느리다.

## 대용량 시스템 아키텍처 맛보기
## 대용량 트래픽 / 데이터 처리는 왜 어려울까
하나의 서버 또는 데이터 베이스로 감당하기 힘든 부하 -> 다수의 서버와 데이터베이스를 마치 하나인 것처럼
웹 서비스들은 24시간 무중단 -> 잘못된 코드 한줄이 미치는 영향의 범위가 큼

그래서 여러 마이크로 서비스들이 복잡한 의존 관계를 가진다.

- 하나의 서버로 감당하기 힘들어 대부분 여러개의 서버 또는 데이터베이스를 사용함.
- 여러개의 서버에서 유입되는 데이터의 일관성을 보장할 수 있어야함
- 코드 한줄이 데이터에 미치는 영향범위가 굉장ㅎ이 커짐
- 여러 서비스들이 얽혀 있어, 시스템 복잡도가 상당히 높음

### 그렇다면 대용량 시스템은 어떠해야하는가?
- 고가용성
	- 언제든 서비스를 이용할 수 있어야한다.
- 확장성
	- 시스템이 비대해짐에 따라 증가하는 데이터와 트래픽에 대응할 수 있어야한다.
- 관측가능성
	- 문제가 생겼을 떄 빠르게 인지할 수 있어야하고 문제의 범위를 최소화 할 수 있어야한다.
### 대용량 시스템의 아키텍처는 어떤 모슴ㅂ을 하고 있는지, 점진적으로 시스템을 발전시켜보자
클라이언트, 서버, 데이터베이스의 구조에서 하나의 서버가 다운 될 경우, 시스템 이용이 어려운 상황이 발생, 트래픽이 증가함에 따라 서버의 응답속도 저하 ->
서버를 추가하게 되는데, 이 떄 부하분산을 고려해야함. 부하분산이 잘 될 수 있도록 서버에 접급하기 전에 Nginx와 같은 로드밸런스를 추가해줌. 이후 서비스가 커지면서 데이터베이스에 병목이 발생하여 응답속도가 느려짐. ->
이에 데이터 베이스의 부담을 줄이는 메모리 캐시를 도입. 캐시에 데이터를 찾고 없으면 데이터베이스에 접근하여 데이터를 가져오면서 캐시서버에 캐싱을 갱신. 서비스에서 대외기관과의 연동 요구 발생 ->
대외기관과의 통신을 카프카나 레빗엠큐와 같은 비동기 큐를 활용하여 비동기로 변경.

![[Pasted image 20240105130458.png|결론적으로 보여지는 서비스 아키텍처 형태]]
